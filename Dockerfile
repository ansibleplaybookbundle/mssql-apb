FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBtc3NxbC1hcGIKZGVzY3JpcHRpb246IERlcGxveW1lbnQg\
b2YgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIgb24gTGludXgKYmluZGFibGU6IHRydWUKYXN5bmM6IG9w\
dGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBNaWNyb3NvZnQgU1FMIFNlcnZlciBvbiBM\
aW51eAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNvbi1tc3NxbAogIGRvY3Vt\
ZW50YXRpb25Vcmw6CiAgICBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy9zcWwvbGlu\
dXgvc3FsLXNlcnZlci1saW51eC1vdmVydmlldwp0YWdzOgogIC0gZGF0YWJhc2UKICAtIG1zc3Fs\
CnBsYW5zOgogIC0gbmFtZTogZXBoZW1lcmFsCiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRl\
cGxveXMgYW4gZXBoZW1lcmFsIE1pY3Jvc29mdCBTUUwgU2VydmVyIG9uIExpbnV4CiAgICBmcmVl\
OiB0cnVlCiAgICBkZWZhdWx0OiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6\
IEVwaGVtZXJhbCBpbnN0YWxsYXRpb24KICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAgIFRo\
aXMgcGxhbiB3aWxsIGRlcGxveSBhIHN0YW5kYWxvbmUgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIgb24g\
TGludXgKICAgICAgICB1c2luZyBlcGhlbWVyYWwgc3RvcmFnZQogICAgcGFyYW1ldGVyczoKICAg\
ICAgLSBuYW1lOiBBQ0NFUFRfRVVMQQogICAgICAgIHRpdGxlOiBBY2NlcHQgdGhlIEVuZC1Vc2Vy\
IExpY2Vuc2luZyBBZ3JlZW1lbnQKICAgICAgICB0eXBlOiBib29sZWFuCiAgICAgICAgcmVxdWly\
ZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIGRlc2NyaXB0aW9uOiBodHRw\
Oi8vZ28ubWljcm9zb2Z0LmNvbS9md2xpbmsvP0xpbmtJZD03NDYzODgKICAgICAgICBkaXNwbGF5\
X2dyb3VwOiBFVUxBIFJlcXVpcmVkCiAgICAgIC0gbmFtZTogTVNTUUxfUEFTU1dPUkQKICAgICAg\
ICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6ICJIZWxsbzEyMyEiCiAgICAgICAgcGF0\
dGVybjogIl4oPzooPzpbYS16XSsuKltBLVpdKy4qKFxcZHxcXFcpKy4qKVwKICAgICAgICAgIHwo\
PzpbQS1aXSsuKlthLXpdKy4qKFxcZHxcXFcpKy4qKVwKICAgICAgICAgIHwoPzooXFxkfFxcVykr\
LipbYS16XS4qW0EtWl0uKil8KD86KFxcZHxcXFcpKy4qW0EtWl0rLipbYS16XSsuKilcCiAgICAg\
ICAgICB8KD86W0EtWl0rLiooXFxkfFxcVykrLipbYS16XSsuKil8KD86W2Etel0rLiooXFxkfFxc\
VykrLipbQS1aXSsuKilcCiAgICAgICAgICB8KD86XFxkKy4qXFxXKy4qKFtBLVpdfFthLXpdKSsu\
Kil8KD86XFxXKy4qXFxkKy4qKFtBLVpdfFthLXpdKSsuKilcCiAgICAgICAgICB8KD86KFtBLVpd\
fFthLXpdKSsuKlxcZCsuKlxcVysuKil8KD86KFtBLVpdfFthLXpdKSsuKlxcVysuKlxcZCsuKilc\
CiAgICAgICAgICB8KD86XFxXKy4qKFtBLVpdfFthLXpdKSsuKlxcZCsuKil8KD86XFxkKy4qKFtB\
LVpdfFthLXpdKSsuKlxcVysuKikpJCIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNw\
bGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgdGl0bGU6ICJEYXRhYmFzZSBBZG1pbiAoU0EpIFBh\
c3N3b3JkIgogICAgICAgIGRlc2NyaXB0aW9uOgogICAgICAgICAgIlRoZSBwYXNzd29yZCBtdXN0\
IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycyBsb25nIGFuZCBjb250YWluCiAgICAgICAgICBjaGFy\
YWN0ZXJzIGZyb20gdGhyZWUgb2YgdGhlIGZvbGxvd2luZyBmb3VyIHNldHM6IFVwcGVyY2FzZQog\
ICAgICAgICAgbGV0dGVycywgTG93ZXJjYXNlIGxldHRlcnMsIEJhc2UgMTAgZGlnaXRzLCBhbmQg\
U3ltYm9scyIKICAgICAgICBkaXNwbGF5X2dyb3VwOiBNaWNyb3NvZnQgU1FMIENvbmZpZwogICAg\
ICAgIG1pbl9sZW5ndGg6IDgKICAgICAgICBtYXhfbGVuZ3RoOiAxMjgKICAgICAgLSBuYW1lOiBN\
U1NRTF9EQVRBQkFTRQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogVGVz\
dERCCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05Xy1dKiQiCiAgICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgICAgdGl0bGU6IE1pY3Jvc29mdCBTUUwgRGF0YWJhc2UgTmFtZQogICAgICAgIGRp\
c3BsYXlfZ3JvdXA6IE1pY3Jvc29mdCBTUUwgQ29uZmlnCiAgICAgIC0gbmFtZTogTVNTUUxfQUdF\
TlRfRU5BQkxFRAogICAgICAgIHRpdGxlOiBFbmFibGUgU1FMIFNlcnZlciBBZ2VudAogICAgICAg\
IHR5cGU6IGJvb2xlYW4KICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IGZh\
bHNlCiAgICAgICAgZGlzcGxheV9ncm91cDogTWljcm9zb2Z0IFNRTCBDb25maWcKICAgICAgLSBu\
YW1lOiBNU1NRTF9QSUQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIHR5cGU6IGVudW0K\
ICAgICAgICBlbnVtOiBbJ0RldmVsb3BlcicsICdFdmFsdWF0aW9uJ10KICAgICAgICBkZWZhdWx0\
OiBEZXZlbG9wZXIKICAgICAgICB0aXRsZTogU1FMIFNlcnZlciBFZGl0aW9uCiAgICAgICAgZGlz\
cGxheV9ncm91cDogTWljcm9zb2Z0IFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9MT0NB\
TF9JUwogICAgICAgIHRpdGxlOiBVc2UgZXhpc3RpbmcgbXNzcWwtc2VydmVyLWxpbnV4IGltYWdl\
c3RyZWFtIGluIHByb2plY3QKICAgICAgICB0eXBlOiBib29sZWFuCiAgICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IE1pY3Jv\
c29mdCBTUUwgQ29uZmlnCiAgICAgIC0gbmFtZTogTVNTUUxfTENJRAogICAgICAgIHRpdGxlOiBM\
YW5ndWFnZSBJRAogICAgICAgIHR5cGU6IGludGVnZXIKICAgICAgICByZXF1aXJlZDogdHJ1ZQog\
ICAgICAgIGRlZmF1bHQ6IDEwMzMKICAgICAgICBkZXNjcmlwdGlvbjogZS5nLiwgMTAzMyBpcyBF\
bmdsaXNoIChVUyksIDEwMzYgaXMgRnJlbmNoCiAgICAgICAgbWluX2xlbmd0aDogNAogICAgICAg\
IG1heF9sZW5ndGg6IDQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBNaWNyb3NvZnQgU1FMIENvbmZp\
ZwogICAgICAtIG5hbWU6IE1TU1FMX0lNQUdFX1BVTEwKICAgICAgICB0aXRsZTogIkRlcGxveW1l\
bnRDb25maWcgSW1hZ2UgUHVsbCBQb2xpY3kiCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGVu\
dW06IFsnQWx3YXlzJywgJ0lmTm90UHJlc2VudCcsICdOZXZlciddCiAgICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAgICAgICBkZWZhdWx0OiBJZk5vdFByZXNlbnQKICAgICAgICBkaXNwbGF5X2dyb3Vw\
OiBNaWNyb3NvZnQgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX01FTU9SWV9MSU1JVAog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMwogICAgICAgIHR5cGU6IGlu\
dGVnZXIKICAgICAgICB0aXRsZToKICAgICAgICAgIE1heGltdW0gYW1vdW50IG9mIG1lbW9yeSB0\
aGUgY29udGFpbmVyIGNhbiB1c2UgKGluIEdCKSBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9n\
cm91cDogRW52aXJvbm1lbnQgU2l6aW5nCiAgICAgIC0gbmFtZTogTVNTUUxfTUVNT1JZX1JFUVVF\
U1QKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDIKICAgICAgICB0eXBl\
OiBpbnRlZ2VyCiAgICAgICAgdGl0bGU6CiAgICAgICAgICBSZXF1ZXN0ZWQgYW1vdW50IG9mIG1l\
bW9yeSBmb3IgdGhlIGNvbnRhaW5lciB0byBzdGFydCAoaW4gR0IpCiAgICAgICAgICBlZyAxR0Ig\
MkdCCiAgICAgICAgZGlzcGxheV9ncm91cDogRW52aXJvbm1lbnQgU2l6aW5nCgogIC0gbmFtZTog\
cGVyc2lzdGVudAogICAgZGVzY3JpcHRpb246IFRoaXMgcGxhbiBkZXBsb3lzIGEgcGVyc2lzdGVu\
dCBNaWNyb3NvZnQgU1FMIFNlcnZlciBvbiBMaW51eAogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRh\
dGE6CiAgICAgIGRpc3BsYXlOYW1lOiBQZXJzaXN0ZW50IGluc3RhbGxhdGlvbgogICAgICBsb25n\
RGVzY3JpcHRpb246CiAgICAgICAgVGhpcyBwbGFuIHdpbGwgZGVwbG95IGEgc3RhbmRhbG9uZSBN\
aWNyb3NvZnQgU1FMIFNlcnZlciBvbiBMaW51eAogICAgICAgIHVzaW5nIHBlcnNpc3RlbnQgc3Rv\
cmFnZQogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBBQ0NFUFRfRVVMQQogICAgICAgIHRp\
dGxlOiBBY2NlcHQgdGhlIEVuZC1Vc2VyIExpY2Vuc2luZyBBZ3JlZW1lbnQKICAgICAgICB0eXBl\
OiBib29sZWFuCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBmYWxzZQog\
ICAgICAgIGRlc2NyaXB0aW9uOiBodHRwOi8vZ28ubWljcm9zb2Z0LmNvbS9md2xpbmsvP0xpbmtJ\
ZD03NDYzODgKICAgICAgICBkaXNwbGF5X2dyb3VwOiBFVUxBIFJlcXVpcmVkCiAgICAgIC0gbmFt\
ZTogTVNTUUxfUEFTU1dPUkQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6\
ICJIZWxsbzEyMyEiCiAgICAgICAgcGF0dGVybjogIl4oPzooPzpbYS16XSsuKltBLVpdKy4qKFxc\
ZHxcXFcpKy4qKVwKICAgICAgICAgIHwoPzpbQS1aXSsuKlthLXpdKy4qKFxcZHxcXFcpKy4qKVwK\
ICAgICAgICAgIHwoPzooXFxkfFxcVykrLipbYS16XS4qW0EtWl0uKil8KD86KFxcZHxcXFcpKy4q\
W0EtWl0rLipbYS16XSsuKilcCiAgICAgICAgICB8KD86W0EtWl0rLiooXFxkfFxcVykrLipbYS16\
XSsuKil8KD86W2Etel0rLiooXFxkfFxcVykrLipbQS1aXSsuKilcCiAgICAgICAgICB8KD86XFxk\
Ky4qXFxXKy4qKFtBLVpdfFthLXpdKSsuKil8KD86XFxXKy4qXFxkKy4qKFtBLVpdfFthLXpdKSsu\
KilcCiAgICAgICAgICB8KD86KFtBLVpdfFthLXpdKSsuKlxcZCsuKlxcVysuKil8KD86KFtBLVpd\
fFthLXpdKSsuKlxcVysuKlxcZCsuKilcCiAgICAgICAgICB8KD86XFxXKy4qKFtBLVpdfFthLXpd\
KSsuKlxcZCsuKil8KD86XFxkKy4qKFtBLVpdfFthLXpdKSsuKlxcVysuKikpJCIKICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgdGl0bGU6\
ICJEYXRhYmFzZSBBZG1pbiAoU0EpIFBhc3N3b3JkIgogICAgICAgIGRlc2NyaXB0aW9uOgogICAg\
ICAgICAgIlRoZSBwYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycyBsb25nIGFu\
ZCBjb250YWluCiAgICAgICAgICBjaGFyYWN0ZXJzIGZyb20gdGhyZWUgb2YgdGhlIGZvbGxvd2lu\
ZyBmb3VyIHNldHM6IFVwcGVyY2FzZQogICAgICAgICAgbGV0dGVycywgTG93ZXJjYXNlIGxldHRl\
cnMsIEJhc2UgMTAgZGlnaXRzLCBhbmQgU3ltYm9scyIKICAgICAgICBkaXNwbGF5X2dyb3VwOiBN\
aWNyb3NvZnQgU1FMIENvbmZpZwogICAgICAgIG1pbl9sZW5ndGg6IDgKICAgICAgICBtYXhfbGVu\
Z3RoOiAxMjgKICAgICAgLSBuYW1lOiBNU1NRTF9EQVRBQkFTRQogICAgICAgIHJlcXVpcmVkOiB0\
cnVlCiAgICAgICAgZGVmYXVsdDogVGVzdERCCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05\
Xy1dKiQiCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE1pY3Jvc29mdCBTUUwg\
RGF0YWJhc2UgTmFtZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IE1pY3Jvc29mdCBTUUwgQ29uZmln\
CiAgICAgIC0gbmFtZTogTVNTUUxfQUdFTlRfRU5BQkxFRAogICAgICAgIHRpdGxlOiBFbmFibGUg\
U1FMIFNlcnZlciBBZ2VudAogICAgICAgIHR5cGU6IGJvb2xlYW4KICAgICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgZGlzcGxheV9ncm91cDogTWljcm9z\
b2Z0IFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9QSUQKICAgICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBlbnVtOiBbJ0RldmVsb3BlcicsICdFdmFs\
dWF0aW9uJ10KICAgICAgICBkZWZhdWx0OiBEZXZlbG9wZXIKICAgICAgICB0aXRsZTogU1FMIFNl\
cnZlciBFZGl0aW9uCiAgICAgICAgZGlzcGxheV9ncm91cDogTWljcm9zb2Z0IFNRTCBDb25maWcK\
ICAgICAgLSBuYW1lOiBNU1NRTF9MT0NBTF9JUwogICAgICAgIHRpdGxlOiBVc2UgZXhpc3Rpbmcg\
bXNzcWwtc2VydmVyLWxpbnV4IGltYWdlc3RyZWFtIGluIHByb2plY3QKICAgICAgICB0eXBlOiBi\
b29sZWFuCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAg\
ICAgIGRpc3BsYXlfZ3JvdXA6IE1pY3Jvc29mdCBTUUwgQ29uZmlnCiAgICAgIC0gbmFtZTogTVNT\
UUxfTENJRAogICAgICAgIHRpdGxlOiBMYW5ndWFnZSBJRAogICAgICAgIHR5cGU6IGludGVnZXIK\
ICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDEwMzMKICAgICAgICBkZXNj\
cmlwdGlvbjogZS5nLiwgMTAzMyBpcyBFbmdsaXNoIChVUyksIDEwMzYgaXMgRnJlbmNoCiAgICAg\
ICAgbWluX2xlbmd0aDogNAogICAgICAgIG1heF9sZW5ndGg6IDQKICAgICAgICBkaXNwbGF5X2dy\
b3VwOiBNaWNyb3NvZnQgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX0lNQUdFX1BVTEwK\
ICAgICAgICB0aXRsZTogIkRlcGxveW1lbnRDb25maWcgSW1hZ2UgUHVsbCBQb2xpY3kiCiAgICAg\
ICAgdHlwZTogZW51bQogICAgICAgIGVudW06IFsnQWx3YXlzJywgJ0lmTm90UHJlc2VudCcsICdO\
ZXZlciddCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBJZk5vdFByZXNl\
bnQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBNaWNyb3NvZnQgU1FMIENvbmZpZwogICAgICAtIG5h\
bWU6IE1TU1FMX0RBVEFfU1RPUkFHRV9TSVpFCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
ICBkZWZhdWx0OiAxCiAgICAgICAgdHlwZTogaW50ZWdlcgogICAgICAgIHRpdGxlOiBQZXJzaXN0\
ZW50IHZvbHVtZSBzaXplIGZvciBkYiBkYXRhIChpbiBHQikgZWcgMUdCIDJHQgogICAgICAgIGRp\
c3BsYXlfZ3JvdXA6IEVudmlyb25tZW50IFNpemluZwogICAgICAtIG5hbWU6IE1TU1FMX01FTU9S\
WV9MSU1JVAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogMwogICAgICAg\
IHR5cGU6IGludGVnZXIKICAgICAgICB0aXRsZToKICAgICAgICAgIE1heGltdW0gYW1vdW50IG9m\
IG1lbW9yeSB0aGUgY29udGFpbmVyIGNhbiB1c2UgKGluIEdCKSBlZyAxR0IgMkdCCiAgICAgICAg\
ZGlzcGxheV9ncm91cDogRW52aXJvbm1lbnQgU2l6aW5nCiAgICAgIC0gbmFtZTogTVNTUUxfTUVN\
T1JZX1JFUVVFU1QKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDIKICAg\
ICAgICB0eXBlOiBpbnRlZ2VyCiAgICAgICAgdGl0bGU6CiAgICAgICAgICBSZXF1ZXN0ZWQgYW1v\
dW50IG9mIG1lbW9yeSBmb3IgdGhlIGNvbnRhaW5lciB0byBzdGFydCAoaW4gR0IpCiAgICAgICAg\
ICBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9ncm91cDogRW52aXJvbm1lbnQgU2l6aW5nCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chown -R apb:0 /opt/{ansible,apb} && \
    chmod -R g=u /opt/{ansible,apb}
USER apb
ENV ANSIBLE_PIPELINING=True \
    ANSIBLE_CALLBACK_WHITELIST=profile_tasks
